
[1A[2K[WebServer] INFO:     Started server process [48120]
[1A[2K[WebServer] INFO:     Waiting for application startup.

[1A[2K[WebServer] Using data dir: D:\Proyectos_Cursor\CometLocal\data

[1A[2K[WebServer] [job_queue] Cargados 18 jobs desde disco

[1A[2K[WebServer] [job_queue] Worker iniciado

[1A[2K[WebServer] Config paths: org=D:\Proyectos_Cursor\CometLocal\data\refs\org.json people=D:\Proyectos_Cursor\CometLocal\data\refs\people.json platforms=D:\Proyectos_Cursor\CometLocal\data\refs\platforms.json secrets=D:\Proyectos_Cursor\CometLocal\data\refs\secrets.json documents=D:\Proyectos_Cursor\CometLocal\data\refs\documents.json

[1A[2K[WebServer] Using existing LLM config: D:\Proyectos_Cursor\CometLocal\backend\..\data\refs\llm_config.json


[1A[2K[WebServer] INFO:     Application startup complete.
[1A[2K[WebServer] INFO:     Uvicorn running on http://127.0.0.1:8000 (Press CTRL+C to quit)

[1A[2K[WebServer] INFO:     127.0.0.1:49978 - "GET /api/health HTTP/1.1" 200 OK


Running 1 test using 1 worker



[1A[2K(node:48460) Warning: The 'NO_COLOR' env is ignored due to the 'FORCE_COLOR' env being set.
(Use `node --trace-warnings ...` to show where the warning was created)


[1A[2K(node:48460) Warning: The 'NO_COLOR' env is ignored due to the 'FORCE_COLOR' env being set.
(Use `node --trace-warnings ...` to show where the warning was created)
[1A[2K[1/1] tests\cae_pack_export_e2e.spec.js:43:5 Ã”Ã‡â•‘ SPRINT C2.11.1: CAE Pack Export E2E Ã”Ã‡â•‘ Genera y descarga pack CAE (ZIP)
[1A[2K[WebServer] INFO:     127.0.0.1:49982 - "GET /api/health HTTP/1.1" 200 OK

[1A[2Ktests\cae_pack_export_e2e.spec.js:43:5 Ã”Ã‡â•‘ SPRINT C2.11.1: CAE Pack Export E2E Ã”Ã‡â•‘ Genera y descarga pack CAE (ZIP)
[E2E] Server health OK - patch: v1.1.1

[1A[2K[WebServer] INFO:     127.0.0.1:49982 - "POST /api/test/seed/reset HTTP/1.1" 200 OK

[1A[2K[SEED] reset status: 200

[1A[2K[WebServer] INFO:     127.0.0.1:49982 - "POST /api/test/seed/basic_repository HTTP/1.1" 200 OK

[1A[2K[SEED] basic_repository status: 200 {
  company_key: [32m'E2E_COMPANY_05c484e6'[39m,
  person_key: [32m'E2E_PERSON_05c484e6'[39m,
  type_ids: [ [32m'E2E_TYPE_05c484e6_0'[39m ],
  doc_ids: [ [32m'E2E_DOC_05c484e6_0_0'[39m, [32m'E2E_DOC_05c484e6_0_1'[39m ],
  period_keys: [ [32m'2025-12'[39m, [32m'2025-11'[39m ],
  message: [32m'Created basic repository: 1 types, 2 docs, 2 missing periods'[39m
}

[1A[2K[WebServer] INFO:     127.0.0.1:58708 - "GET /repository HTTP/1.1" 200 OK

[1A[2K[CONSOLE LOG] [BOOT] __REPO_SCRIPT_LOADED__ = true

[1A[2K[CONSOLE LOG] [BOOT] repository_v3 script loaded

[1A[2K[CONSOLE LOG] [BOOT] typeof window.ensureCalendarioLoaded: function

[1A[2K[CONSOLE LOG] [BOOT] __REPO_API_READY__ set to true

[1A[2K[CONSOLE LOG] [BOOT] ensureCalendarioLoaded defined

[1A[2K[CONSOLE LOG] [BOOT] window.ensureCalendarioLoaded === undefined ? DEFINED

[1A[2K[CONSOLE LOG] [repo-upload] listener installed {time: 1768402115652}

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768402115683 bootstrap: start

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768402115683 bootstrap: app-ready set

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768402115684 initHashRouting: registering hashchange listener

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768402115684 bootstrap: calling runRoutingNow for initial hash

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768402115684 runRoutingNow: hash=, route=null

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768402115684 runRoutingNow: normalizing hash from  to #inicio

[1A[2K[WebServer] INFO:     127.0.0.1:55979 - "GET /api/health HTTP/1.1" 200 OK

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768402115685 bootstrap: completed

[1A[2K[CONSOLE LOG] [BOOT] __REPO_BOOTSTRAP_DONE__ set to true

[1A[2K[CONSOLE LOG] [EVENT] DOMContentLoaded

[1A[2K[CONSOLE LOG] [EVENT] window load

[1A[2K[WebServer] INFO:     127.0.0.1:55979 - "GET /api/repository/types HTTP/1.1" 200 OK

[1A[2K[CONSOLE LOG] [EVENT] hashchange -> #inicio

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768402115687 hashchange event fired

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768402115687 runRoutingNow: hash=#inicio, route=inicio

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768402115687 updateNavActive: updated nav for route=inicio

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768402115687 runRoutingNow: calling loadPage(inicio)

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768402115687 loadPage: start page=inicio

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768402115687 loadPage: content.innerHTML set to loading

[1A[2K[CONSOLE LOG] [SETVIEWSTATE] inicio loaded readyState= complete body exists= true

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768402115688 setViewState: inicio -> loaded on view-state-root

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768402115688 setViewState: inicio -> loaded applied, testId=view-inicio-loaded

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768402115690 bootstrap: E2E mode detected: true

[1A[2K[CONSOLE LOG] [EVENT] hashchange -> #calendario

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768402115717 hashchange event fired

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768402115717 runRoutingNow: hash=#calendario, route=calendario

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768402115717 updateNavActive: updated nav for route=calendario

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768402115717 runRoutingNow: calling loadPage(calendario)

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768402115718 loadPage: start page=calendario

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768402115718 loadPage: content.innerHTML set to loading

[1A[2K[CONSOLE LOG] [SETVIEWSTATE] calendario loaded readyState= complete body exists= true

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768402115718 setViewState: calendario -> loaded on view-state-root

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768402115718 setViewState: calendario -> loaded applied, testId=view-calendario-loaded

[1A[2K[CONSOLE LOG] [CAL] start

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768402115718 loadCalendario: start

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768402115719 ensureRepoDataLoaded: start

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768402115719 Loading types...

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768402115719 Loading people...

[1A[2K[CONSOLE LOG] [SETVIEWSTATE] calendario loaded readyState= complete body exists= true

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768402115732 setViewState: calendario -> loaded on view-state-root

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768402115732 setViewState: calendario -> loaded applied, testId=view-calendario-loaded

[1A[2K[CONSOLE LOG] [CAL] start

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768402115732 loadCalendario: start

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768402115732 ensureRepoDataLoaded: start

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768402115732 Loading types...

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768402115732 Loading people...

[1A[2K[WebServer] INFO:     127.0.0.1:54013 - "GET /api/repository/docs?limit=50&sort=date_desc HTTP/1.1" 200 OK

[1A[2K[WebServer] INFO:     127.0.0.1:58994 - "GET /api/repository/rules HTTP/1.1" 200 OK

[1A[2K[WebServer] INFO:     127.0.0.1:59687 - "GET /api/config/platforms HTTP/1.1" 200 OK

[1A[2K[WebServer] INFO:     127.0.0.1:55979 - "GET /api/repository/types HTTP/1.1" 200 OK

[1A[2K[WebServer] INFO:     127.0.0.1:62820 - "GET /favicon.ico HTTP/1.1" 404 Not Found

[1A[2K[WebServer] INFO:     127.0.0.1:63093 - "GET /api/config/people HTTP/1.1" 200 OK

[1A[2K[CONSOLE LOG] [SETVIEWSTATE] inicio ready readyState= complete body exists= true

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768402115934 setViewState: inicio -> ready on view-state-root

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768402115934 setViewState: inicio -> ready applied, testId=view-inicio-ready

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768402115934 runRoutingNow: loadPage(inicio) completed

[1A[2K[WebServer] INFO:     127.0.0.1:58994 - "GET /api/repository/types HTTP/1.1" 200 OK

[1A[2K[WebServer] INFO:     127.0.0.1:59687 - "GET /favicon.ico HTTP/1.1" 404 Not Found

[1A[2K[CONSOLE ERROR] Failed to load resource: the server responded with a status of 404 (Not Found)

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768402115935 Types loaded:

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768402115935 People loaded:

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768402115935 ensureRepoDataLoaded: done

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768402115935 loadCalendario: max_months_back=12 (E2E=true, original=24)

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768402115935 loadCalendario: before fetch pendings

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768402115937 Types loaded:

[1A[2K[CONSOLE ERROR] Failed to load resource: the server responded with a status of 404 (Not Found)

[1A[2K[WebServer] INFO:     127.0.0.1:62820 - "GET /api/config/people HTTP/1.1" 200 OK

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768402115944 People loaded:

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768402115944 ensureRepoDataLoaded: done

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768402115944 loadCalendario: max_months_back=12 (E2E=true, original=24)

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768402115944 loadCalendario: before fetch pendings

[1A[2K[WebServer] [PENDING] ms_total=36, ms_read=15, ms_calc=0, ms_missing=16, counts=docs=36, expired=36, expiring=0, missing=10

[1A[2K[WebServer] INFO:     127.0.0.1:63093 - "GET /api/repository/docs/pending?months_ahead=3&max_months_back=12 HTTP/1.1" 200 OK

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768402115982 loadCalendario: after fetch pendings

[1A[2K[CONSOLE LOG] [CAL] after fetch pending {expired: 36, expiringSoon: 0, missing: 10}

[1A[2K[WebServer] [PENDING] ms_total=38, ms_read=15, ms_calc=0, ms_missing=17, counts=docs=36, expired=36, expiring=0, missing=10

[1A[2K[WebServer] INFO:     127.0.0.1:62820 - "GET /api/repository/docs/pending?months_ahead=3&max_months_back=12 HTTP/1.1" 200 OK

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768402116023 loadCalendario: after fetch pendings

[1A[2K[CONSOLE LOG] [CAL] after fetch pending {expired: 36, expiringSoon: 0, missing: 10}

[1A[2K[WebServer] INFO:     127.0.0.1:63093 - "GET /api/repository/subjects HTTP/1.1" 200 OK

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768402116035 loadCalendario: after render table

[1A[2K[WebServer] INFO:     127.0.0.1:62820 - "GET /api/repository/subjects HTTP/1.1" 200 OK

[1A[2K[CONSOLE LOG] [CAL] after render

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768402116035 loadCalendario: end

[1A[2K[CONSOLE LOG] [CAL] end

[1A[2K[CONSOLE LOG] [SETVIEWSTATE] calendario ready readyState= complete body exists= true

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768402116036 setViewState: calendario -> ready on view-state-root

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768402116036 setViewState: calendario -> ready applied, testId=view-calendario-ready

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768402116036 runRoutingNow: loadPage(calendario) completed

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768402116057 loadCalendario: after render table

[1A[2K[CONSOLE LOG] [CAL] after render

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768402116057 loadCalendario: end

[1A[2K[CONSOLE LOG] [CAL] end

[1A[2K[CONSOLE LOG] [SETVIEWSTATE] calendario ready readyState= complete body exists= true

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768402116058 setViewState: calendario -> ready on view-state-root

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768402116058 setViewState: calendario -> ready applied, testId=view-calendario-ready

[1A[2K[WebServer] INFO:     127.0.0.1:62820 - "GET /api/config/platforms HTTP/1.1" 200 OK

[1A[2K[CONSOLE LOG] [repo-upload] change captured {targetTag: SELECT, hasClass: false, fileIdAttr: null, time: 1768402116706}

[1A[2K[CONSOLE LOG] [repo-upload] change captured {targetTag: SELECT, hasClass: false, fileIdAttr: null, time: 1768402116916}

[1A[2K[CONSOLE LOG] [repo-upload] change captured {targetTag: SELECT, hasClass: false, fileIdAttr: null, time: 1768402117132}

[1A[2K[WebServer] INFO:     127.0.0.1:62820 - "POST /api/cae/plan HTTP/1.1" 200 OK

[1A[2K[E2E] Plan no tiene documentos seleccionados. Usando doc_ids del seed directamente.

[1A[2K[E2E] Seed doc_ids: [ [32m'E2E_DOC_05c484e6_0_0'[39m, [32m'E2E_DOC_05c484e6_0_1'[39m ]

[1A[2K[CONSOLE LOG] [repo-upload] change captured {targetTag: SELECT, hasClass: false, fileIdAttr: null, time: 1768402117498}

[1A[2K[E2E] Llamando directamente al endpoint del pack con [33m2[39m doc_ids

[1A[2K[WebServer] INFO:     127.0.0.1:62820 - "POST /api/repository/cae/pack HTTP/1.1" 200 OK

[1A[2K[E2E] Download filename: CAE_PACK_generic_2026-01-14_154837.zip

[1A[2K[E2E] Download saved: D:\Proyectos_Cursor\CometLocal\docs\evidence\cae_pack\CAE_PACK_generic_2026-01-14_154837.zip (1507 bytes)

[1A[2K[E2E] ZIP signature validated: PK

[1A[2K[E2E] Pack export test completed successfully

[1A[2K  1 passed (10.4s)
