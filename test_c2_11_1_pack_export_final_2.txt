
[1A[2K[WebServer] INFO:     Started server process [48268]
[1A[2K[WebServer] INFO:     Waiting for application startup.

[1A[2K[WebServer] Using data dir: D:\Proyectos_Cursor\CometLocal\data

[1A[2K[WebServer] [job_queue] Cargados 18 jobs desde disco

[1A[2K[WebServer] [job_queue] Worker iniciado

[1A[2K[WebServer] Config paths: org=D:\Proyectos_Cursor\CometLocal\data\refs\org.json people=D:\Proyectos_Cursor\CometLocal\data\refs\people.json platforms=D:\Proyectos_Cursor\CometLocal\data\refs\platforms.json secrets=D:\Proyectos_Cursor\CometLocal\data\refs\secrets.json documents=D:\Proyectos_Cursor\CometLocal\data\refs\documents.json

[1A[2K[WebServer] Using existing LLM config: D:\Proyectos_Cursor\CometLocal\backend\..\data\refs\llm_config.json


[1A[2K[WebServer] INFO:     Application startup complete.
[1A[2K[WebServer] INFO:     Uvicorn running on http://127.0.0.1:8000 (Press CTRL+C to quit)

[1A[2K[WebServer] INFO:     127.0.0.1:60429 - "GET /api/health HTTP/1.1" 200 OK


Running 1 test using 1 worker


[1A[2K(node:49556) Warning: The 'NO_COLOR' env is ignored due to the 'FORCE_COLOR' env being set.
(Use `node --trace-warnings ...` to show where the warning was created)



[1A[2K(node:49556) Warning: The 'NO_COLOR' env is ignored due to the 'FORCE_COLOR' env being set.
(Use `node --trace-warnings ...` to show where the warning was created)
[1A[2K[1/1] tests\cae_pack_export_e2e.spec.js:43:5 Ã”Ã‡â•‘ SPRINT C2.11.1: CAE Pack Export E2E Ã”Ã‡â•‘ Genera y descarga pack CAE (ZIP)
[1A[2K[WebServer] INFO:     127.0.0.1:60431 - "GET /api/health HTTP/1.1" 200 OK

[1A[2Ktests\cae_pack_export_e2e.spec.js:43:5 Ã”Ã‡â•‘ SPRINT C2.11.1: CAE Pack Export E2E Ã”Ã‡â•‘ Genera y descarga pack CAE (ZIP)
[E2E] Server health OK - patch: v1.1.1

[1A[2K[WebServer] INFO:     127.0.0.1:60431 - "POST /api/test/seed/reset HTTP/1.1" 200 OK

[1A[2K[SEED] reset status: 200

[1A[2K[WebServer] INFO:     127.0.0.1:60431 - "POST /api/test/seed/basic_repository HTTP/1.1" 200 OK

[1A[2K[SEED] basic_repository status: 200 {
  company_key: [32m'E2E_COMPANY_daf85a5b'[39m,
  person_key: [32m'E2E_PERSON_daf85a5b'[39m,
  type_ids: [ [32m'E2E_TYPE_daf85a5b_0'[39m ],
  doc_ids: [ [32m'E2E_DOC_daf85a5b_0_0'[39m, [32m'E2E_DOC_daf85a5b_0_1'[39m ],
  period_keys: [ [32m'2025-12'[39m, [32m'2025-11'[39m ],
  message: [32m'Created basic repository: 1 types, 2 docs, 2 missing periods'[39m
}

[1A[2K[WebServer] INFO:     127.0.0.1:51442 - "GET /repository HTTP/1.1" 200 OK

[1A[2K[CONSOLE LOG] [BOOT] __REPO_SCRIPT_LOADED__ = true

[1A[2K[CONSOLE LOG] [BOOT] repository_v3 script loaded

[1A[2K[CONSOLE LOG] [BOOT] typeof window.ensureCalendarioLoaded: function

[1A[2K[CONSOLE LOG] [BOOT] __REPO_API_READY__ set to true

[1A[2K[CONSOLE LOG] [BOOT] ensureCalendarioLoaded defined

[1A[2K[CONSOLE LOG] [BOOT] window.ensureCalendarioLoaded === undefined ? DEFINED

[1A[2K[CONSOLE LOG] [repo-upload] listener installed {time: 1768400930574}

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768400930605 bootstrap: start

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768400930606 bootstrap: app-ready set

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768400930606 initHashRouting: registering hashchange listener

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768400930606 bootstrap: calling runRoutingNow for initial hash

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768400930607 runRoutingNow: hash=, route=null

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768400930607 runRoutingNow: normalizing hash from  to #inicio

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768400930607 bootstrap: completed

[1A[2K[CONSOLE LOG] [BOOT] __REPO_BOOTSTRAP_DONE__ set to true

[1A[2K[CONSOLE LOG] [EVENT] DOMContentLoaded

[1A[2K[CONSOLE LOG] [EVENT] window load

[1A[2K[WebServer] INFO:     127.0.0.1:56305 - "GET /api/health HTTP/1.1" 200 OK

[1A[2K[CONSOLE LOG] [EVENT] hashchange -> #inicio

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768400930609 hashchange event fired

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768400930609 runRoutingNow: hash=#inicio, route=inicio

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768400930609 updateNavActive: updated nav for route=inicio

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768400930609 runRoutingNow: calling loadPage(inicio)

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768400930609 loadPage: start page=inicio

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768400930610 loadPage: content.innerHTML set to loading

[1A[2K[CONSOLE LOG] [SETVIEWSTATE] inicio loaded readyState= complete body exists= true

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768400930610 setViewState: inicio -> loaded on view-state-root

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768400930610 setViewState: inicio -> loaded applied, testId=view-inicio-loaded

[1A[2K[WebServer] INFO:     127.0.0.1:61913 - "GET /api/repository/types HTTP/1.1" 200 OK

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768400930629 bootstrap: E2E mode detected: true

[1A[2K[CONSOLE LOG] [EVENT] hashchange -> #calendario

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768400930638 hashchange event fired

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768400930638 runRoutingNow: hash=#calendario, route=calendario

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768400930638 updateNavActive: updated nav for route=calendario

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768400930638 runRoutingNow: calling loadPage(calendario)

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768400930639 loadPage: start page=calendario

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768400930639 loadPage: content.innerHTML set to loading

[1A[2K[CONSOLE LOG] [SETVIEWSTATE] calendario loaded readyState= complete body exists= true

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768400930639 setViewState: calendario -> loaded on view-state-root

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768400930639 setViewState: calendario -> loaded applied, testId=view-calendario-loaded

[1A[2K[CONSOLE LOG] [CAL] start

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768400930639 loadCalendario: start

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768400930640 ensureRepoDataLoaded: start

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768400930640 Loading types...

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768400930640 Loading people...

[1A[2K[CONSOLE LOG] [SETVIEWSTATE] calendario loaded readyState= complete body exists= true

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768400930652 setViewState: calendario -> loaded on view-state-root

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768400930652 setViewState: calendario -> loaded applied, testId=view-calendario-loaded

[1A[2K[CONSOLE LOG] [CAL] start

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768400930652 loadCalendario: start

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768400930652 ensureRepoDataLoaded: start

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768400930652 Loading types...

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768400930652 Loading people...

[1A[2K[WebServer] INFO:     127.0.0.1:56305 - "GET /api/repository/docs?limit=50&sort=date_desc HTTP/1.1" 200 OK

[1A[2K[WebServer] INFO:     127.0.0.1:50174 - "GET /api/repository/rules HTTP/1.1" 200 OK

[1A[2K[WebServer] INFO:     127.0.0.1:61913 - "GET /favicon.ico HTTP/1.1" 404 Not Found

[1A[2K[CONSOLE ERROR] Failed to load resource: the server responded with a status of 404 (Not Found)

[1A[2K[WebServer] INFO:     127.0.0.1:52131 - "GET /api/config/platforms HTTP/1.1" 200 OK

[1A[2K[WebServer] INFO:     127.0.0.1:52078 - "GET /api/repository/types HTTP/1.1" 200 OK

[1A[2K[CONSOLE LOG] [SETVIEWSTATE] inicio ready readyState= complete body exists= true

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768400930809 setViewState: inicio -> ready on view-state-root

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768400930809 setViewState: inicio -> ready applied, testId=view-inicio-ready

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768400930809 runRoutingNow: loadPage(inicio) completed

[1A[2K[WebServer] INFO:     127.0.0.1:54814 - "GET /api/config/people HTTP/1.1" 200 OK

[1A[2K[WebServer] INFO:     127.0.0.1:56305 - "GET /favicon.ico HTTP/1.1" 404 Not Found

[1A[2K[WebServer] INFO:     127.0.0.1:52131 - "GET /api/repository/types HTTP/1.1" 200 OK

[1A[2K[CONSOLE ERROR] Failed to load resource: the server responded with a status of 404 (Not Found)

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768400930819 Types loaded:

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768400930819 People loaded:

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768400930820 ensureRepoDataLoaded: done

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768400930820 loadCalendario: max_months_back=12 (E2E=true, original=24)

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768400930820 loadCalendario: before fetch pendings

[1A[2K[WebServer] INFO:     127.0.0.1:52078 - "GET /api/config/people HTTP/1.1" 200 OK

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768400930825 Types loaded:

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768400930825 People loaded:

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768400930825 ensureRepoDataLoaded: done

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768400930825 loadCalendario: max_months_back=12 (E2E=true, original=24)

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768400930825 loadCalendario: before fetch pendings

[1A[2K[WebServer] [PENDING] ms_total=27, ms_read=11, ms_calc=1, ms_missing=11, counts=docs=30, expired=30, expiring=0, missing=10

[1A[2K[WebServer] INFO:     127.0.0.1:56305 - "GET /api/repository/docs/pending?months_ahead=3&max_months_back=12 HTTP/1.1" 200 OK

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768400930854 loadCalendario: after fetch pendings

[1A[2K[CONSOLE LOG] [CAL] after fetch pending {expired: 30, expiringSoon: 0, missing: 10}

[1A[2K[WebServer] [PENDING] ms_total=33, ms_read=13, ms_calc=1, ms_missing=13, counts=docs=30, expired=30, expiring=0, missing=10

[1A[2K[WebServer] INFO:     127.0.0.1:52078 - "GET /api/repository/docs/pending?months_ahead=3&max_months_back=12 HTTP/1.1" 200 OK

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768400930889 loadCalendario: after fetch pendings

[1A[2K[CONSOLE LOG] [CAL] after fetch pending {expired: 30, expiringSoon: 0, missing: 10}

[1A[2K[WebServer] INFO:     127.0.0.1:56305 - "GET /api/repository/subjects HTTP/1.1" 200 OK

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768400930901 loadCalendario: after render table

[1A[2K[WebServer] INFO:     127.0.0.1:52078 - "GET /api/repository/subjects HTTP/1.1" 200 OK

[1A[2K[CONSOLE LOG] [CAL] after render

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768400930901 loadCalendario: end

[1A[2K[CONSOLE LOG] [CAL] end

[1A[2K[CONSOLE LOG] [SETVIEWSTATE] calendario ready readyState= complete body exists= true

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768400930901 setViewState: calendario -> ready on view-state-root

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768400930901 setViewState: calendario -> ready applied, testId=view-calendario-ready

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768400930901 runRoutingNow: loadPage(calendario) completed

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768400930920 loadCalendario: after render table

[1A[2K[CONSOLE LOG] [CAL] after render

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768400930920 loadCalendario: end

[1A[2K[CONSOLE LOG] [CAL] end

[1A[2K[CONSOLE LOG] [SETVIEWSTATE] calendario ready readyState= complete body exists= true

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768400930920 setViewState: calendario -> ready on view-state-root

[1A[2K[CONSOLE LOG] [VIEWDBG] 1768400930920 setViewState: calendario -> ready applied, testId=view-calendario-ready

[1A[2K[WebServer] INFO:     127.0.0.1:52078 - "GET /api/config/platforms HTTP/1.1" 200 OK

[1A[2K[CONSOLE LOG] [repo-upload] change captured {targetTag: SELECT, hasClass: false, fileIdAttr: null, time: 1768400931562}

[1A[2K[CONSOLE LOG] [repo-upload] change captured {targetTag: SELECT, hasClass: false, fileIdAttr: null, time: 1768400931788}

[1A[2K[CONSOLE LOG] [repo-upload] change captured {targetTag: SELECT, hasClass: false, fileIdAttr: null, time: 1768400932005}

[1A[2K[WebServer] INFO:     127.0.0.1:52078 - "POST /api/cae/plan HTTP/1.1" 200 OK

[1A[2K[E2E] Plan no tiene documentos seleccionados. Usando doc_ids del seed directamente.

[1A[2K[E2E] Seed doc_ids: [ [32m'E2E_DOC_daf85a5b_0_0'[39m, [32m'E2E_DOC_daf85a5b_0_1'[39m ]

[1A[2K[CONSOLE LOG] [repo-upload] change captured {targetTag: SELECT, hasClass: false, fileIdAttr: null, time: 1768400932392}

[1A[2K[E2E] Llamando directamente al endpoint del pack con [33m2[39m doc_ids

[1A[2K[WebServer] INFO:     127.0.0.1:52078 - "POST /api/repository/cae/pack HTTP/1.1" 200 OK

[1A[2K[E2E] Download filename: CAE_PACK_generic_2026-01-14_152852.zip

[1A[2K[E2E] Download saved: D:\Proyectos_Cursor\CometLocal\docs\evidence\cae_pack\CAE_PACK_generic_2026-01-14_152852.zip (1508 bytes)

[1A[2K[E2E] ZIP signature validated: PK

[1A[2K[E2E] Pack export test completed successfully

[1A[2K  1 passed (10.2s)
